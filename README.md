# vortex_identification
Примененение эйлеровых методов идентификации вихрей (Q, $\Delta$, $\lambda_2$, swirling strength ($\lambda_{ci}$) и Rortex) к численным данным атмосферы с целью поиска мезомасштабных когерентных вихревых структур (КВС). Репозиторий содержит:
1. коды для расчета трехмерных полей КВС
2. коды для расчета траекторий КВС

# Структура

Папка `examples` содержит пример применения функций на различных данных:

`compute_rortex_year.py` содержит пример применения Rortex-критерия на данных NAAD HiRes. Итогом работы скрипта является совокупность массивов критериев в формате NetCDF.


Папка `vortex_dir` содержит функции обработки данных:
- `load_data.py` - загрузка данных NAAD
- `compute_criteria.py` - расчет тензора градиента скорости и прочих сопутсвующих операций линейной алгебры, а также расчет самих критериев (функции `compute_{что-то}`)

  ВНИМАНИЕ: функции корректно работают преимущественно для массивов с shape=(time, level, y, x)

- `vortex_processing.py` - функции постобработки массивов критериев - кластеризация КВС (`clustering_DBSCAN`), расчет статистики (`get_stat`) и сопутствующие им функции
  
  ВНИМАНИЕ: функции корректно работают преимущественно для массивов с shape=(y, x)

- `show_vortex.py` - функции отрисовки выделенных КВС (требует доработки)


Папка `tracking_dir` содержит функции для построения траекторий КВС на основе критериев и с использованием DBSCAN-кластеризации:

- `DBSCAN_tracking_step_by_step.py` - пример расчета траекторий Ц/АЦ КС для данных NAAD HiRes и Rortex-критерия. Итогом работы скрипта является совокупность траектори Ц/АЦ КВС в формате csv.

 ВНИМАНИЕ: для кластеризации используется функция `clustering_DBSCAN_rortex_C` - надо добавить в гит

- `tracking_step_by_step.py` - содержит функцию инициализации новых траекторий `track_init`, шага трекинга `step_of_tracking`, а также дополнительные функции
