# vortex_identification

Implementation of Eulerian vortex identification criteria 

## Описание

Этот репозиторий предоставляет инструменты для анализа мезомасштабных когерентных вихревых структур в атмосфере с использованием эйлеровых методов идентификации когерентных вихревых структур (КВС, Coherent Vortical Structures, CVS).  Реализован расчет Q, $\Delta$, $\lambda_2$, swirling strength ($\lambda_{ci}$) и Rortex критериев на основе численных данных атмосферы (на вход принимаются двумерные или трехмерные поля скорости). Также реализованы функции для расчета первичной статистики КВС (размеры, форма, термодинамические параметры).

# Структура

├── examples
│ └── compute_rortex_year.py
└── vortex_dir
    ├── load_data.py
    ├── compute_criteria.py
    ├── vortex_processing.py
    └── show_vortex.py

## Расчет КВС
Папка `vortex_dir` содержит функции обработки данных:
- `load_data.py` - загрузка данных ([NAAD](https://naad.ocean.ru/), [ERA5](https://www.ecmwf.int/en/forecasts/dataset/ecmwf-reanalysis-v5))
- `compute_criteria.py` - расчет тензора градиента скорости и прочих сопутсвующих операций линейной алгебры, а также расчет самих критериев (функции `compute_{что-то}`)

  ВНИМАНИЕ: функции корректно работают преимущественно для массивов с shape=(time, level, y, x)

- `vortex_processing.py` - функции постобработки массивов критериев: кластеризация КВС (`clustering_DBSCAN`), расчет статистики (`get_stat`) и сопутствующие им функции
  
  ВНИМАНИЕ: функции корректно работают преимущественно для массивов с shape=(y, x)

- `show_vortex.py` - функции отрисовки выделенных КВС (требует доработки)


## Примеры работы
Папка `examples` содержит пример применения функций на различных данных:

`compute_rortex_year.py` содержит пример применения Rortex-критерия на данных NAAD HiRes. Итогом работы скрипта является совокупность массивов критериев в формате NetCDF.

